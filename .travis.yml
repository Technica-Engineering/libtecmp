language: c
dist: focal
arch:
  - amd64
  - arm64
  - ppc64le
  - s390x

compiler:
  - gcc
  - clang

install:
  - sudo pip install --upgrade pip
  
  - sudo pip install cmake
  - alias cmake='python -m cmake'
  - cmake --version
  
  - sudo pip install conan
  - conan remote add public-conan https://api.bintray.com/conan/bincrafters/public-conan
  - conan install -s build_type=Release conanfile.txt

script:
  - cmake -E make_directory build
  - cd build
  - cmake .. -DCMAKE_BUILD_TYPE=Release
  - cmake --build . --config Release
  - ctest -C Release --output-on-failure
